# ddd_check

![CI](https://img.shields.io/github/actions/workflow/status/abe-tetsu/ddd_check/go.yml?branch=main&label=test)

## 概要
domain層で定義されている構造体とIDについてチェックするツールです。

## 使い方
### install
```shell
go install github.com/abe-tetsu/ddd_check
```

### 実行
go.modがあるディレクトリで実行してください。
domain層を探し、その配下にあるファイルについてチェックします。
```shell
go vet -vettool=$(which ddd_check) ./...
``` 

## 具体的なケース
### 確認する内容
- IDの型が定義されていて、その名前がファイル名と一致すること
  - 例: user_chat.go には、UserChatIDという型が定義されていること
- 定義されているIDを生成するコンストラクタが存在し、その名前がファイル名と一致すること
  - 例: user_chat.go には、NewUserChatIDというコンストラクタが定義されていること
- 構造体の名前がファイル名と一致すること
  - 例: user_chat.go には、UserChatという構造体が定義されていること
- 構造体のコンストラクタが存在し、その名前がファイル名を含んでいること
  - 例: user_chat.go には、NewUserChatというコンストラクタが定義されていること
  - ファイル名が含んでいれば良いので、NewUserChatByRequestでも許される。
  - 複数個のコンストラクタがあっても良いが、全てファイル名を含んでいる必要がある

## 注意事項
- ファイル名と変数名の大文字と小文字は区別していません。
- ファイル名がローワーケースであることを前提としています。
  - キャメルケースに変換して、さらに小文字に変換して、一致するかどうか確認しています。
- 構造体のコンストラクタ名は、ファイル名が含まれていれば警告を出しません。
  - 例: user_data.go では、UserDataという文字列が含んでいたらエラーにならないようにしています。
  - これは複数個のコンストラクタにも対応するためです。

[//]: # ()
[//]: # (// ケース)

[//]: # (// 1. そもそも ID 型で定義されていない => コンストラクタをみる必用がない)

[//]: # (// // // 1-1-1. 構造体も定義されていない　=> コンストラクタをみる必要がない)

[//]: # (// // // 1-1-2. 構造体が定義されているが、名前がファイル名と一致していない)

[//]: # (// // // // 1-1-2-1. コンストラクタが定義されていない)

[//]: # (// // // // 1-1-2-2. コンストラクタが定義されているが、名前がファイル名と一致していない)

[//]: # (// // // // 1-1-2-3. コンストラクタが定義されていて、名前がファイル名と一致している)

[//]: # (// // // 1-1-3. 構造体が定義されていて、名前がファイル名と一致している)

[//]: # (// // // // 1-1-3-1. コンストラクタが定義されていない)

[//]: # (// // // // 1-1-3-2. コンストラクタが定義されているが、名前がファイル名と一致していない)

[//]: # (// // // // 1-1-3-3. コンストラクタが定義されていて、名前がファイル名と一致している)

[//]: # ()
[//]: # (// 2. ID 型で定義されているが、名前がファイル名と一致していない => コンストラクタも見て、名前が一致しているか確認)

[//]: # (// // 2-1. コンストラクタが定義されていない)

[//]: # (// // 2-2. コンストラクタが定義されているが、名前がファイル名と一致していない)

[//]: # (// // 2-3. コンストラクタが定義されていて、名前がファイル名と一致している)

[//]: # (// 3. ID 型で定義されていて、名前がファイル名と一致している => コンストラクタも見て、名前が一致しているか確認)

[//]: # (// // 3-1. コンストラクタが定義されていない)

[//]: # (// // 3-2. コンストラクタが定義されているが、名前がファイル名と一致していない)

[//]: # (// // 3-3. コンストラクタが定義されていて、名前がファイル名と一致している)
